import React, { useState } from 'react';
import { Search, Bell, HelpCircle, BookOpen, CheckCircle, AlertTriangle, ClipboardList, ChevronRight, Star, Heart, MessageSquare, Share2, Users, Clock, TrendingDown } from 'lucide-react';

const BaoMaShuoApp = () => {
  const [activeTab, setActiveTab] = useState('decision');
  const [babyAge, setBabyAge] = useState('3-6ä¸ªæœˆ');

  // äº”å¤§å†³ç­–å…¥å£
  const decisionEntries = [
    {
      icon: HelpCircle,
      title: 'æ€ä¹ˆé€‰',
      subtitle: 'é€‰å‰å†³ç­–',
      desc: 'åŒæœˆé¾„çœŸå®åé¦ˆ',
      color: 'from-blue-500 to-cyan-500',
      badge: 'æœ€é«˜é¢‘'
    },
    {
      icon: BookOpen,
      title: 'æ€ä¹ˆç”¨',
      subtitle: 'ä½¿ç”¨è¿‡ç¨‹',
      desc: 'é¿å…é”™è¯¯ç”¨æ³•',
      color: 'from-purple-500 to-pink-500'
    },
    {
      icon: CheckCircle,
      title: 'å€¼ä¸å€¼',
      subtitle: 'çœŸå®è¯„ä»·',
      desc: 'ç”¨è¿‡çš„æ‰çŸ¥é“',
      color: 'from-green-500 to-emerald-500',
      badge: 'æœ€çœŸå®'
    },
    {
      icon: AlertTriangle,
      title: 'é¿å‘æ¦œ',
      subtitle: 'è´Ÿåé¦ˆ',
      desc: 'å“ªäº›åˆ«ä¹°',
      color: 'from-red-500 to-orange-500',
      badge: 'ç‹¬å®¶'
    }
  ];

  // é¿å‘è­¦ç¤º
  const pitfallAlerts = [
    {
      product: 'XXå“ç‰Œé˜²èƒ€æ°”å¥¶ç“¶',
      issue: '32%çš„3-6ä¸ªæœˆå®å®ä»ç„¶èƒ€æ°”ä¸¥é‡',
      userCount: 78,
      severity: 'high'
    },
    {
      product: 'YYç”µåŠ¨å¸å¥¶å™¨',
      issue: 'ä½¿ç”¨1ä¸ªæœˆåæ•…éšœç‡é«˜è¾¾45%',
      userCount: 124,
      severity: 'high'
    }
  ];

  // çƒ­é—¨å†³ç­–é—®é¢˜
  const hotQuestions = [
    {
      category: 'å¥¶ç“¶æ€ä¹ˆé€‰',
      question: 'PPSUå’Œç»ç’ƒå¥¶ç“¶æ€ä¹ˆé€‰ï¼Ÿ',
      answers: 234,
      realUsers: 156,
      age: '0-3ä¸ªæœˆ'
    },
    {
      category: 'å¥¶å˜´æ€ä¹ˆé€‰',
      question: 'å®å®æ‹’ç»å¥¶å˜´æ€ä¹ˆåŠï¼Ÿ',
      answers: 189,
      realUsers: 123,
      age: '3-6ä¸ªæœˆ'
    }
  ];

  // çœŸå®ä½¿ç”¨åé¦ˆ
  const realFeedbacks = [
    {
      id: 1,
      user: { 
        name: 'å°é›¨å¦ˆå¦ˆ', 
        avatar: 'ğŸ‘©', 
        level: 'Lv5', 
        age: '3ä¸ªæœˆå®å®', 
        useDays: 45 
      },
      product: {
        name: 'Comotomoå¯ä¹ˆå¤šä¹ˆå¥¶ç“¶',
        brand: 'Comotomo',
        image: 'ğŸ¼',
        price: 'Â¥128',
        originalPrice: 'Â¥189',
        rating: 4.8,
        reviewCount: 234
      },
      rating: 'recommend',
      summary: 'ä»180mlç”¨åˆ°ç°åœ¨ï¼Œå®å®æ¥å—åº¦é«˜ï¼Œæ²¡èƒ€æ°”',
      detail: 'ç”¨äº†45å¤©ï¼Œå®å®ä¸€ç›´å¾ˆå–œæ¬¢ï¼Œå¥¶å˜´æŸ”è½¯åº¦æ¥è¿‘æ¯ä¹³ï¼Œè½¬å¥¶å¾ˆé¡ºåˆ©ã€‚æ¸…æ´—ä¹Ÿæ–¹ä¾¿ï¼Œç“¶èº«å®½å£è®¾è®¡...',
      tags: ['é˜²èƒ€æ°”æœ‰æ•ˆ', 'æ˜“æ¸…æ´—', 'å®å®æ¥å—åº¦é«˜'],
      replaceFrom: 'XXå“ç‰Œç»ç’ƒå¥¶ç“¶',
      replaceReason: 'ä¹‹å‰é‚£æ¬¾èƒ€æ°”ä¸¥é‡',
      stats: { helpful: 234, comments: 56 }
    },
    {
      id: 2,
      user: { 
        name: 'æ™´å¤©å¦ˆå¦ˆ', 
        avatar: 'ğŸ‘±â€â™€ï¸', 
        level: 'Lv3', 
        age: '5ä¸ªæœˆå®å®', 
        useDays: 15 
      },
      product: {
        name: 'babycareè¾…é£Ÿç¢—',
        brand: 'babycare',
        image: 'ğŸ¥£',
        price: 'Â¥68',
        originalPrice: 'Â¥118',
        rating: 3.2,
        reviewCount: 189
      },
      rating: 'not-recommend',
      summary: 'å¸ç›˜ä¸ç‰¢ï¼Œå®å®ä¸€æ‹‰å°±æ‰ï¼Œå·²é—²ç½®',
      detail: 'ä¹°å›æ¥ç”¨äº†3æ¬¡å°±ä¸ç”¨äº†ï¼Œå¸ç›˜æ ¹æœ¬å¸ä¸ä½ï¼Œå®å®ä¸€æ‹½å°±æ‰ã€‚æœ¬æ¥æƒ³ç€å¸ç›˜è®¾è®¡èƒ½é˜²æ­¢æ‰“ç¿»...',
      tags: ['å¸ç›˜ä¸ç‰¢', 'å®¹æ˜“æ‰“ç¿»', 'æ€§ä»·æ¯”ä½'],
      abandoned: true,
      stats: { helpful: 156, comments: 34 }
    }
  ];

  // å¿«é€Ÿå·¥å…·
  const quickTools = [
    { emoji: 'ğŸ¼', title: '3åˆ†é’Ÿé€‰å¥¶ç“¶', users: '2.3ä¸‡äººç”¨è¿‡' },
    { emoji: 'ğŸ“‹', title: 'åŒæœˆé¾„å¿…å¤‡æ¸…å•', users: '5.6ä¸‡äººæ”¶è—' },
    { emoji: 'âš–ï¸', title: 'å“ç‰Œå¯¹æ¯”å·¥å…·', users: '1.8ä¸‡äººç”¨è¿‡' }
  ];

  return (
    <div className="max-w-md mx-auto bg-gray-50 min-h-screen flex flex-col">
      {/* é¡¶éƒ¨ - å¼ºåŒ–ç”¨æˆ·èº«ä»½ */}
      <div className="bg-gradient-to-r from-blue-500 to-purple-500 px-4 py-4 text-white sticky top-0 z-50">
        <div className="flex items-center justify-between mb-3">
          <div>
            <div className="text-2xl font-bold mb-1">å®å¦ˆè¯´</div>
            <div className="text-sm opacity-90">çœŸå®å†³ç­–ï¼Œä¸è¸©å‘</div>
          </div>
          <div className="flex items-center gap-3">
            <Search className="w-5 h-5" />
            <div className="relative">
              <Bell className="w-5 h-5" />
              <div className="absolute -top-1 -right-1 bg-red-500 rounded-full w-4 h-4 text-xs flex items-center justify-center">3</div>
            </div>
          </div>
        </div>
        
        {/* å®å®æœˆé¾„é€‰æ‹©å™¨ - æ ¸å¿ƒä¸Šä¸‹æ–‡ */}
        <div className="bg-white/20 backdrop-blur-sm rounded-xl p-3 flex items-center justify-between">
          <div className="flex items-center gap-2">
            <div className="text-2xl">ğŸ‘¶</div>
            <div>
              <div className="text-xs opacity-80">å½“å‰æŸ¥çœ‹</div>
              <div className="font-semibold">{babyAge} å®å®</div>
            </div>
          </div>
          <button className="bg-white/30 px-3 py-1 rounded-lg text-sm">
            åˆ‡æ¢æœˆé¾„ â†’
          </button>
        </div>
      </div>

      {/* ä¸»å†…å®¹åŒº */}
      <div className="flex-1 overflow-y-auto pb-20">
        
        {/* äº”å¤§å†³ç­–å…¥å£ */}
        <div className="p-4">
          <div className="mb-3 flex items-center justify-between">
            <h2 className="font-bold text-gray-800 text-lg">æˆ‘è¦åšå†³ç­–</h2>
            <span className="text-xs text-gray-500">é€‰æ‹©ä½ çš„é˜¶æ®µ</span>
          </div>
          
          <div className="grid grid-cols-2 gap-3 mb-3">
            {decisionEntries.map((entry, idx) => (
              <button
                key={idx}
                className="relative bg-white rounded-2xl p-4 shadow-sm hover:shadow-md transition-shadow text-left overflow-hidden"
              >
                <div className={`absolute top-0 right-0 w-20 h-20 bg-gradient-to-br ${entry.color} opacity-10 rounded-full -mr-8 -mt-8`}></div>
                
                {entry.badge && (
                  <div className="absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-0.5 rounded-full">
                    {entry.badge}
                  </div>
                )}
                
                <entry.icon className={`w-8 h-8 mb-2 bg-gradient-to-br ${entry.color} text-white p-1.5 rounded-xl`} />
                <div className="font-bold text-gray-800 mb-0.5">{entry.title}</div>
                <div className="text-xs text-gray-500 mb-1">{entry.subtitle}</div>
                <div className="text-xs text-gray-600">{entry.desc}</div>
              </button>
            ))}
          </div>

          {/* æ¸…å•å·¥å…· */}
          <button className="w-full bg-gradient-to-r from-amber-500 to-yellow-500 text-white rounded-2xl p-4 shadow-sm flex items-center justify-between">
            <div className="flex items-center gap-3">
              <ClipboardList className="w-8 h-8" />
              <div className="text-left">
                <div className="font-bold">æ¸…å•ä¸å·¥å…·</div>
                <div className="text-sm opacity-90">ç›´æ¥å‘Šè¯‰æˆ‘ä¹°ä»€ä¹ˆ</div>
              </div>
            </div>
            <ChevronRight className="w-5 h-5" />
          </button>
        </div>

        {/* é¿å‘è­¦ç¤ºåŒº */}
        <div className="px-4 pb-4">
          <div className="bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl p-4 border border-red-200">
            <div className="flex items-center gap-2 mb-3">
              <AlertTriangle className="w-5 h-5 text-red-600" />
              <h3 className="font-bold text-gray-800">é¿å‘è­¦ç¤º</h3>
              <span className="text-xs text-red-600 bg-red-100 px-2 py-0.5 rounded-full ml-auto">
                å®æ—¶æ›´æ–°
              </span>
            </div>
            
            {pitfallAlerts.map((alert, idx) => (
              <div key={idx} className="bg-white rounded-xl p-3 mb-2 last:mb-0">
                <div className="flex items-start gap-2">
                  <TrendingDown className={`w-4 h-4 mt-0.5 flex-shrink-0 ${
                    alert.severity === 'high' ? 'text-red-500' : 'text-orange-500'
                  }`} />
                  <div className="flex-1 min-w-0">
                    <div className="font-medium text-sm text-gray-800 mb-1">
                      {alert.product}
                    </div>
                    <div className="text-xs text-gray-600 mb-2">
                      {alert.issue}
                    </div>
                    <div className="flex items-center gap-2 text-xs text-gray-500">
                      <Users className="w-3 h-3" />
                      <span>{alert.userCount}ä½å®å¦ˆåé¦ˆ</span>
                    </div>
                  </div>
                </div>
              </div>
            ))}
            
            <button className="w-full mt-2 text-sm text-red-600 font-medium py-2">
              æŸ¥çœ‹å®Œæ•´é¿å‘æ¦œ â†’
            </button>
          </div>
        </div>

        {/* çƒ­é—¨å†³ç­–é—®é¢˜ */}
        <div className="px-4 pb-4">
          <div className="flex items-center justify-between mb-3">
            <h3 className="font-bold text-gray-800">åŒæœˆé¾„éƒ½åœ¨é—®</h3>
            <span className="text-xs text-gray-500">{babyAge}</span>
          </div>
          
          <div className="space-y-2">
            {hotQuestions.map((q, idx) => (
              <div key={idx} className="bg-white rounded-xl p-4 shadow-sm">
                <div className="flex items-start gap-3">
                  <div className="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                    <HelpCircle className="w-5 h-5 text-blue-600" />
                  </div>
                  <div className="flex-1 min-w-0">
                    <div className="text-xs text-blue-600 mb-1">{q.category}</div>
                    <div className="font-medium text-gray-800 mb-2">{q.question}</div>
                    <div className="flex items-center gap-3 text-xs text-gray-500">
                      <span className="flex items-center gap-1">
                        <MessageSquare className="w-3 h-3" />
                        {q.answers}ä¸ªå›ç­”
                      </span>
                      <span className="flex items-center gap-1">
                        <Users className="w-3 h-3" />
                        {q.realUsers}ä½çœŸå®ç”¨æˆ·
                      </span>
                      <span className="bg-purple-100 text-purple-600 px-2 py-0.5 rounded">
                        {q.age}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>

        {/* çœŸå®ä½¿ç”¨åé¦ˆæµ */}
        <div className="px-4 pb-4">
          <div className="flex items-center justify-between mb-3">
            <h3 className="font-bold text-gray-800">çœŸå®ä½¿ç”¨åé¦ˆ</h3>
            <button className="text-xs text-blue-600 bg-blue-50 px-3 py-1 rounded-lg">ç­›é€‰æ¡ä»¶</button>
          </div>
          
          <div className="space-y-3">
            {realFeedbacks.map((feedback) => (
              <div key={feedback.id} className="bg-white rounded-2xl p-4 shadow-sm">
                {/* ç”¨æˆ·ä¿¡æ¯ + ä½¿ç”¨å¤©æ•° */}
                <div className="flex items-center justify-between mb-3">
                  <div className="flex items-center gap-2">
                    <div className="text-2xl">{feedback.user.avatar}</div>
                    <div>
                      <div className="flex items-center gap-2">
                        <span className="font-medium text-sm">{feedback.user.name}</span>
                        <span className="text-xs bg-gradient-to-r from-yellow-400 to-orange-400 text-white px-2 py-0.5 rounded">
                          {feedback.user.level}
                        </span>
                      </div>
                      <div className="flex items-center gap-1 text-xs text-gray-500">
                        <span>{feedback.user.age}</span>
                        <span>â€¢</span>
                        <Clock className="w-3 h-3" />
                        <span>å·²ä½¿ç”¨ {feedback.user.useDays} å¤©</span>
                      </div>
                    </div>
                  </div>
                  <div className={`px-3 py-1 rounded-lg text-sm font-medium ${
                    feedback.rating === 'recommend' 
                      ? 'bg-green-100 text-green-700'
                      : 'bg-red-100 text-red-700'
                  }`}>
                    {feedback.rating === 'recommend' ? 'æ¨è' : 'ä¸æ¨è'}
                  </div>
                </div>

                {/* äº§å“å¡ç‰‡ */}
                <div className="flex gap-3 p-3 bg-gray-50 rounded-xl mb-3 border border-gray-200">
                  <div className="w-20 h-20 bg-white rounded-lg flex items-center justify-center text-4xl flex-shrink-0 border border-gray-200">
                    {feedback.product.image}
                  </div>
                  <div className="flex-1 flex flex-col justify-between">
                    <div>
                      <div className="text-xs text-gray-500 mb-1">{feedback.product.brand}</div>
                      <div className="text-sm font-semibold text-gray-800 mb-1 line-clamp-2">
                        {feedback.product.name}
                      </div>
                    </div>
                    <div>
                      <div className="flex items-center gap-2 mb-1">
                        <span className="text-red-500 font-bold">{feedback.product.price}</span>
                        <span className="text-xs text-gray-400 line-through">{feedback.product.originalPrice}</span>
                      </div>
                      <div className="flex items-center gap-1 text-xs text-gray-500">
                        <Star className="w-3 h-3 fill-yellow-400 text-yellow-400" />
                        <span>{feedback.product.rating}åˆ†</span>
                        <span>â€¢</span>
                        <span>{feedback.product.reviewCount}æ¡è¯„ä»·</span>
                      </div>
                    </div>
                  </div>
                </div>

                {/* ä¸€å¥è¯æ€»ç»“ */}
                <div className="text-sm text-gray-700 mb-2 bg-gray-50 p-2 rounded-lg">
                  ğŸ’¬ {feedback.summary}
                </div>

                {/* è¯¦ç»†å†…å®¹ */}
                <div className="text-sm text-gray-600 mb-3 line-clamp-2">
                  {feedback.detail}
                </div>

                {/* æ ‡ç­¾ */}
                <div className="flex flex-wrap gap-2 mb-3">
                  {feedback.tags.map((tag, i) => (
                    <span key={i} className={`text-xs px-2 py-1 rounded ${
                      feedback.rating === 'recommend'
                        ? 'bg-green-50 text-green-700'
                        : 'bg-red-50 text-red-700'
                    }`}>
                      {tag}
                    </span>
                  ))}
                </div>

                {/* æ›¿æ¢ä¿¡æ¯ */}
                {feedback.replaceFrom && (
                  <div className="text-xs text-orange-600 bg-orange-50 p-2 rounded-lg mb-3">
                    âš ï¸ ä»ã€Œ{feedback.replaceFrom}ã€æ¢è¿‡æ¥ï¼š{feedback.replaceReason}
                  </div>
                )}

                {/* å¼ƒç”¨è­¦ç¤º */}
                {feedback.abandoned && (
                  <div className="text-xs text-red-600 bg-red-50 p-2 rounded-lg mb-3">
                    âŒ å·²å¼ƒç”¨ï¼šå®é™…ä½¿ç”¨ä½“éªŒä¸ä½³
                  </div>
                )}

                {/* äº’åŠ¨æ  */}
                <div className="flex items-center justify-between pt-3 border-t">
                  <button className="flex items-center gap-1 text-gray-600">
                    <Star className="w-4 h-4" />
                    <span className="text-sm">{feedback.stats.helpful}äººè§‰å¾—æœ‰ç”¨</span>
                  </button>
                  <button className="flex items-center gap-1 text-gray-600">
                    <MessageSquare className="w-4 h-4" />
                    <span className="text-sm">{feedback.stats.comments}</span>
                  </button>
                  <button className="text-blue-600 text-sm font-medium">
                    æŸ¥çœ‹è¯¦æƒ… â†’
                  </button>
                </div>
              </div>
            ))}
          </div>
        </div>

        {/* å¿«é€Ÿå†³ç­–å·¥å…· */}
        <div className="px-4 pb-6">
          <h3 className="font-bold text-gray-800 mb-3">å¿«é€Ÿå†³ç­–å·¥å…·</h3>
          <div className="grid grid-cols-1 gap-2">
            {quickTools.map((tool, idx) => (
              <button key={idx} className="bg-white rounded-xl p-4 shadow-sm flex items-center justify-between hover:shadow-md transition-shadow">
                <div className="flex items-center gap-3">
                  <div className="text-3xl">{tool.emoji}</div>
                  <div className="text-left">
                    <div className="font-medium text-gray-800">{tool.title}</div>
                    <div className="text-xs text-gray-500">{tool.users}</div>
                  </div>
                </div>
                <ChevronRight className="w-5 h-5 text-gray-400" />
              </button>
            ))}
          </div>
        </div>
      </div>

      {/* åº•éƒ¨å¯¼èˆª */}
      <div className="bg-white border-t px-4 py-2 flex items-center justify-around fixed bottom-0 left-0 right-0 max-w-md mx-auto z-50">
        {[
          { icon: HelpCircle, label: 'å†³ç­–', value: 'decision' },
          { icon: AlertTriangle, label: 'é¿å‘', value: 'pitfall', badge: 'æ–°' },
          { icon: ClipboardList, label: 'æ¸…å•', value: 'list' },
          { icon: Users, label: 'åœˆå­', value: 'circle' },
          { label: 'æˆ‘çš„', value: 'profile', isEmoji: true, emoji: 'ğŸ‘¤' },
        ].map((item) => (
          <button
            key={item.value}
            onClick={() => setActiveTab(item.value)}
            className={`flex flex-col items-center gap-1 relative ${
              activeTab === item.value ? 'text-blue-600' : 'text-gray-600'
            }`}
          >
            {item.isEmoji ? (
              <span className="text-2xl">{item.emoji}</span>
            ) : (
              <item.icon className="w-6 h-6" />
            )}
            <span className="text-xs">{item.label}</span>
            {item.badge && (
              <div className="absolute -top-1 -right-2 bg-red-500 text-white text-xs px-1.5 py-0.5 rounded-full">
                {item.badge}
              </div>
            )}
          </button>
        ))}
      </div>
    </div>
  );
};

export default BaoMaShuoApp;
